<%= form_for @discovery_rule, :url => (@discovery_rule.new_record? ? discovery_rules_path : discovery_rule_path(:id => @discovery_rule.id)) do |f| %>
  <%= base_errors_for @discovery_rule %>
  <%= text_f f, :name %>
  <%= autocomplete_f f, :search,
                     :path => "discovered_hosts",
                     :control_group_id => 'search_group', :size => 'col-md-9' %>
  <%= select_f f, :hostgroup_id, accessible_hostgroups, :id, :to_label, { :include_blank => false },
    { :help_inline => _('Target host group for this rule with all properties set')} %>
  <%= text_f f, :hostname, :help_inline => popover(_("Target hostname template pattern"),_("<dl>" +
                                                                  "<dd>Domain will be appended automatically.</dd>" +
                                                                  "<dd>A hostname based on MAC address will be used when left blank.</dd>" +
                                                                  "<dd>Use ERB templating to access host attributes and facts. Examples:</dd>" +
                                                                  "<li>myhost-\<%= rand(99999) %%\></li>" +
                                                                  "<li>myhost-\<%= @host.facts['bios_vendor'] + '-' + rand(99999) %%\></li>" +
                                                                  "<li>myhost-\<%= @host.hostgroup.name %%\></li>" +
                                                                  "<li>myhost-\<%= @host.discovery_rule.name %%\></li>" +
                                                                  "<li>myhost-\<%= @host.ip.gsub('.','-') + '-' + @host.hostgroup.subnet.name %%\></li>" +
                                                                  "<dd>When creating hostname patterns, make sure the resulting host names are unique.</dd>" +
                                                                  "<dd>A good approach is to use unique information provided by facter (MAC address, BIOS or serial ID).</dd>" +
                                                                  "</dl>"), :title => _("Hostname for provisioned hosts")).html_safe %>
  <%= text_f f, :max_count, :label => _('Hosts limit'), :help_inline => _('Maximum hosts provisioned with this rule (0 = unlimited)') %>
  <%= text_f f, :priority, :help_inline => _('Rule priority (lower integer means higher priority)')  %>
  <%= checkbox_f f, :enabled %>
  <%= submit_or_cancel f %>
<% end %>
